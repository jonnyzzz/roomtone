# Architecture

Roomtone is a single-room mesh call. Each browser connects to the signaling server over WebSocket, then establishes direct WebRTC peer connections to every other participant.

## Components

- Browser UI (React + TypeScript)
- Signaling server (Node.js + Express + ws)
- TURN relay (coturn) for NAT traversal

## Data Flow

```
+-----------+          WebSocket           +-----------------+
|  Browser  |  <------------------------>  |  Node Signaling |
+-----------+                               +-----------------+
      |                                               |
      |   WebRTC peer connections (mesh)              |
      +-----------------+-----------------------------+
                        |
                +---------------+
                |  Other peers  |
                +---------------+
```

When TURN is enabled, media can relay through coturn instead of going direct.

## Signaling Messages

All clients join the same room. The server tracks participant IDs and forwards signaling payloads.

- `join` -> client sends name, server responds with `welcome`.
- `peer-joined` -> server notifies existing peers to create offers.
- `signal` -> clients exchange SDP offers/answers and ICE candidates.
- `peer-left` -> server notifies peers to clean up.

## Room Model

There is exactly one room. Participant IDs are generated by the server. Names are provided by the client and limited to 40 characters.

## Scaling Notes

This project uses mesh WebRTC: every participant connects directly to every other participant. For 10 participants, each client can have up to 9 peer connections. For larger rooms or lower-powered devices, an SFU (Selective Forwarding Unit) would be the next step.
